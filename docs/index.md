<img src="data:image/jpeg;base64,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" width="480" title="hover text">


### Projeto

Reconhecimento facial: identificação do operador presente no equipamento.

Desenvolvedores: 

Gabriel Mauly | gabriel.mauly@solinftec.com.br 

Rene Gonzalez | rene.gonzalez@solinftec.com.br

### Arquitetura
    
    environment.yml  # Dependências do projeto
    mkdocs.yml       # Arquivo de configuração.
    docs/
        index.md     # Página da documentação.    
    images/          # Faces a serem treinadas e reconhecidas
    models/          # contém os modelos treinados
        codes.npy    
        imagens.npy  
        names.npy     
    Operador.py      # Algoritmo principal, realiza o reconhecimento e comunicação serial
    Treinamento.py   # Realiza o treinamento das faces

### Anaconda

Para usuários anaconda, abra o terminal na pasta do projeto e utilize o seguinte comando para instalar as dependências:

* conda env create -f environment.yml

### Comandos

Para executar o treinamento de novas faces utilize:

* python Treinamento.py 

<b>obs:</b> é necessário editar o arquivo Treinamento.py, adicionando a última linha qual função
de treinamento deseja utilizar train() ou train_pc().

Para rodar o reconhecimento facial utilize:

* python Operador.py  
    
### Codificação

Explicação das classes implementadas

#### Class Treinamento.py

Bibliotecas:
   
    import face_recognition as fr   
    import glob
    import numpy as np 
    import os
    from time import time

Funções:

<b>split_string()</b>    
       
Converte o valor de uma string em uma lista de acordo com o critério de separação passado como parâmetro.
    
    split_string(value, char)
        value: (string) valor a ser convertido em lista
        char:  (string) critério de separação
    
    Exemplo:
    
    >> data = '10.gabriel.jpg'
    
    >> value = split_string(value=data, char='.')
    
    >> print(value)
    
    >> ['10', 'gabriel', 'jpg]
        
<b>train()</b>
    
Realiza o treinamento das faces no dispositivo (atualmente raspberry Pi), não é necessário passar nenhum
parâmetro, pois o mesmo realiza a leitura das imagens e gera os modelos treinados.

<b>train_pc()</b>
    
Realiza o treinamento das faces no desktop, a diferença está na maneira que o SO local trata o sistema
de diretórios.
   
#### Class Operador.py


Bibliotecas:
   
    from __future__ import print_function
    from imutils.video import WebcamVideoStream
    from imutils.video import FPS
    import argparse
    import imutils
    import cv2
    import dlib
    import face_recognition as fr
    import multiprocessing
    import numpy as np
    import os
    import serial
    import shutil
    import _thread as tr  
    import time
    from Treinamento import split_string, train

Funções:

<b>check_sum()</b>
    
Gera o check sum da mensagem (dígito que valida a integridade da informação)
    
    check_sum(hexadecimal):
        hexadecimal: (string) mensagem (informação) que precisa do dígito validador
    
    Exemplo:
        
    >> mensagem = '$PNEUD,G,0,1,'
        
    >> mensagem = check_sum(hexadecimal=mensagem)
        
    >> print(mensagem)
        
    >> 28
        
<b>init_board()</b>
    
Responsável por iniciar a comunicação serial com o bordo, não é necessário passar nenhum parêmtro, tem como
retorno a conexão estabelecida.

<b>identifier_face()</b>
    
Responsável por identificar um rosto para o cadastro automático, retorna a face reconhecida para treinamento.
    
    identifier_face(mean, tempo, camera, fps):
        mean:   (float) Média de confiança na identificação de uma face
        tempo:  (int) Tempo máximo para realizar a identificação da face
        camera: (object) Câmera responsável por ler os frames
        fps:    (object) Atualiza o fps do frame  
        
<b>wait_ok()</b>

Responsável por aguardar a confirmação de recebimento do bordo.
    
    wait_ok(message, tempo):
        message: (string) mensagem a ser enviada para o bordo
        tempo: (int) tempo máximo de espera para receber a confirmação

<b>send_message()</b>

Responsável por enviar mensagem para o bordo pela porta serial
    
    send_message(board, message, tempo):
        
        board: (object) Objeto com a conexão serial
        message: (string) mensagem a ser enviada
        tempo: (int) caso tenha que aguardar confirmação, tempo máximo de espera


<b>load_models()</b>
    
Responsável por carregar os modelos treinados.

<b>alter_turn()</b>
    
Responsável em definir o tempo de espera para a troca de turno.
    
    alter_turn(timeout):
        timeout: (int) tempo de espera.

<b>read_serial()</b>

Responsável por realizar a leitura das informações na porta serial
    
    read_serial(board, flags, conn):
        
        board: (object) Conexão com a porta serial
        flags: (object) Variável de comunicação entre processos
        conn:  (object) Comunicação entre processos

<b>recognition()</b>

Responsável por realizar o reconhecimento facial
    
    recognition(board, flags, conn):
        
        board: (object) Conexão com a porta serial
        flags: (object) Variável de comunicação entre processos
        conn:  (object) Comunicação entre processos

